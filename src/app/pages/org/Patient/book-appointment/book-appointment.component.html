<div class="container">
  <div class="mt-2">
    <form class="row g-3" [formGroup]="appointmentForm">
      <div class="col-md-3">
        <label for="specializationName" class="form-label form-labelStart"
          >Specialization</label
        >
        <select
          class="form-select"
          id="specializationName"
          formControlName="specializationId"
          (input)="onChangeSpecilization($event)"
        >
          <option value="0">All</option>
          <option
            *ngFor="let specility of specializationList"
            value="{{ specility.specialisationId }}"
          >
            {{ specility.specialisationName }}
          </option>
        </select>
        <div class="invalid-feedback">Please select a valid state.</div>
      </div>

      <div class="col-md-3">
        <label for="Provider" class="form-label form-labelStart"
          >Provider</label
        >
        <select
          class="form-select mb-0"
          id="Provider"
          formControlName="providerId"
          (change)="onChangeProvider($event)"
        >
          <option selected disabled value="">Select Provider</option>
          <option *ngFor="let pro of providersList" value="{{ pro.userId }}">
            {{ pro.firstName + " " + pro.lastName }}
          </option>
        </select>

        <div>
          <div
            style="font-size: 13px"
            *ngIf="
              isSubmitClick ||
              appointmentForm.controls['providerId'].touched ||
              appointmentForm.controls['providerId'].dirty
            "
          >
            <div
              *ngIf="
                appointmentForm.controls['providerId'].hasError('required')
              "
            >
              <div class="text-danger">*required</div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-3">
        <label for="validationDefault02" class="form-label"> Fee </label>
        <div class="mt-2">$ {{ fee ? fee : "--" }}</div>
      </div>

      <div class="col-md-3">
        <label for="validationDefault02" class="form-label form-labelStart">
          Date Of Appointment
        </label>
        <input
          type="date"
          class="form-control mb-0"
          id="validationDefault02"
          value="Otto"
          formControlName="appointmentDate"
          [min]="todaysDate()"
        />
        <div
          style="font-size: 13px"
          *ngIf="
            isSubmitClick ||
            appointmentForm.controls['appointmentDate'].touched ||
            appointmentForm.controls['appointmentDate'].dirty
          "
        >
          <div
            *ngIf="
              appointmentForm.controls['appointmentDate'].hasError('required')
            "
          >
            <div class="text-danger">*required</div>
          </div>
        </div>
      </div>

      <div class="col-md-3">
        <label for="startTime" class="form-label form-labelStart">
          Start Time
        </label>
        <input
          type="time"
          class="form-control mb-0"
          id="startTime"
          formControlName="startTime"
        />

        <div
          style="font-size: 13px"
          *ngIf="
            isSubmitClick ||
            appointmentForm.controls['startTime'].touched ||
            appointmentForm.controls['startTime'].dirty
          "
        >
          <div
            *ngIf="appointmentForm.controls['startTime'].hasError('required')"
          >
            <div class="text-danger">*required</div>
          </div>
        </div>
      </div>

      <div class="col-md-3">
        <label for="startTime" class="form-label form-labelStart">
          End Time
        </label>
        <input
          type="time"
          class="form-control mb-0"
          id="startTime"
          formControlName="endTime"
        />

        <div
          style="font-size: 13px"
          *ngIf="
            isSubmitClick ||
            appointmentForm.controls['endTime'].touched ||
            appointmentForm.controls['endTime'].dirty
          "
        >
          <div *ngIf="appointmentForm.controls['endTime'].hasError('required')">
            <div class="text-danger">*required</div>
          </div>

          <div
            *ngIf="appointmentForm.get('endTime')?.hasError('invalidEndTime')"
            class="text-danger small"
          >
            End time must be within one hour of the start time.
          </div>
        </div>
      </div>

      <div class="col-md-5 px-4">
        <div class="row">
          <label for="ChiefComplaint" class="form-label form-labelStart">
            Chief Complaint
          </label>
          <textarea
            class="form-control"
            name="ChiefComplaint"
            id="ChiefComplaint"
            rows="5"
            cols=""
            formControlName="chiefComplaint"
          ></textarea>

          <div
            style="font-size: 13px"
            *ngIf="
              isSubmitClick ||
              appointmentForm.controls['chiefComplaint'].touched ||
              appointmentForm.controls['chiefComplaint'].dirty
            "
          >
            <div
              *ngIf="
                appointmentForm.controls['chiefComplaint'].hasError('required')
              "
            >
              <div class="text-danger">*required</div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-12">
        <button type="button" class="btn btn-primary" (click)="openModal()">
          Pay and Book
        </button>
        <button
          type="button"
          class="btn btn-danger mx-3"
          (click)="resetAppointmentForm()"
        >
          Reset
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal for Card -->
<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Enter Card Details</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <div>
            <label for="card-number">Card Number:</label>
            <div id="card-number" #cardNumber></div>
          </div>

          <div>
            <label for="card-expiry">Expiry Date:</label>
            <div id="card-expiry" #expiryInput></div>
          </div>

          <div>
            <label for="card-cvv">CVV:</label>
            <div id="card-cvv" #cvvInput></div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeModal()">
          Close
        </button>
        <button
          type="button"
          class="btn btn-primary"
          (click)="onClickPayButton()"
        >
          Pay
        </button>
      </div>
    </div>
  </div>
</div>

@if (isLoader) {
<div class="loader-backdrop">
  <span class="loader"></span>
</div>
}
